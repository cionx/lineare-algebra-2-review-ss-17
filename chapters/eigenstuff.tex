\section{Diagonalisierbarkeit}

Im Folgenden sei $K$ ein Körper.
Im Rest des Abschnittes sei, sofern nicht anders angegeben, $V$ ein endlichdimensionaler $K$-Vektorraum.





\subsection{Eigenwerte und Eigenvektoren}

\begin{definition}
  Es sei $f \colon V \to V$ ein Endomorphismus.
  Sind $\lambda \in K$ und $v \in V$ mit $v \neq 0$ und $f(v) = \lambda v$, so ist $v$ ein \emph{Eigenvektor} von $f$ zum \emph{Eigenwert} $\lambda$.
  Für alle $\lambda \in K$ ist der Untervektorraum
  \[
              \eigenspace{V}{f}{\lambda}
    \coloneqq \{ v \in V \suchthat f(v) = \lambda f \}
    =         \ker (f - \lambda \id_V)
  \]
  der \emph{Eigenraum} von $f$ zu $\lambda$.

  Es sei $n \in \Natural$ und $A \in \matrices{n}{K}$.
  Sind $\lambda \in K$ und $x \in K^n$ mit $x \neq 0$ und $Ax = \lambda x$, so ist $x$ ein \emph{Eigenvektor} von $A$ zum \emph{Eigenwert} $\lambda$.
  Für alle $\lambda \in K$ ist der Untervektorraum
  \[
              \eigenspace{(K^n)}{A}{\lambda}
    \coloneqq \{ x \in K^n \suchthat Ax = \lambda x \}
    =         \ker (A - \lambda \Id)
  \]
  der \emph{Eigenraum} von $A$ zu $\lambda$.
\end{definition}

\begin{remark}
  \begin{enumerate}
    \item
      Ist $A \in \matrices{n}{K}$ und $f \colon K^n \to K^n$, $x \mapsto Ax$ der zu $A$ (bezüglich der Standardbasis) gehörige Endomorphismus, so stimmen die Eigenvektoren, Eigenwerte und Eigenräume von $A$ mit denen von $f$ überein.
      
      Es genügt daher im Folgenden, Definitionen und Aussagen für Endomorphismen zu anzugeben -- für Matrizen gelten diese dann ebenfalls.
    \item
      Es sei $f \colon V \to V$ ein Endomorphismus eines $K$-Vektorraums $V$, $\basis{B} = (v_1, \dotsc, v_n)$ eine Basis von $V$ und $A \coloneqq \repmatrixendo{f}{\basis{B}}$ die entsprechende darstellende Matrix.
      Bezüglich des zu $\basis{B}$ zugehörigen Isomorphismus
      \begin{gather*}
                  \Phi_{\basis{B}}
        \colon    V
        \to       K^n,
        \quad       v
                  = \sum_{i=1}^n x_i v_i
        \mapsto   \transpose{(x_1, \dotsc, x_n)}
        \eqqcolon [v]_{\basis{B}}
      \shortintertext{gilt}
          \Phi_{\basis{B}}\left( \eigenspace{V}{f}{\lambda} \right)
        = \eigenspace{(K^n)}{A}{\lambda}.
      \end{gather*}
      Es ist also $v \in V$ genau dann ein Eigenvektor von $f$ zum Eigenwert $\lambda \in K$, wenn $[v]_{\basis{B}}$ ein Eigenvektor von $A$ zum Eigenwert $\lambda$ ist.
      
      Berechnungen lassen sich deshalb in Matrizenform durchführen.
  \end{enumerate}
\end{remark}

Für theoretische Aussagen nutzen wir also Endomorphismen, und für konkrete Rechnungen nutzen wir Matrizen.





\subsection{Das charakterische Polynom}

Es sei $f \colon V \to V$ ein Endomorphismus, $\basis{B}$ eine Basis von $V$ und $A \coloneqq \repmatrixendo{f}{\basis{B}}$ die entsprechende darstellende Matrix.
Dann gilt
\begin{align*}
      &\, \text{$\lambda$ ist ein Eigenwert von $f$}      \\
  \iff&\, \text{$\lambda$ ist ein Eigenwert von $A$}      \\
  \iff&\, \eigenspace{(K^n)}{A}{\lambda} \neq 0           \\
  \iff&\, \ker (A - \lambda \Id) \neq 0                   \\
  \iff&\, \text{$A - \lambda \Id$ ist nicht invertierbar} \\
  \iff&\, \det (A - \lambda \Id) = 0.
\end{align*}

\begin{definition}
  Das \emph{charakterische Polynom} von $A \in \matrices{n}{K}$ ist definiert als
  \[
              \charpol{A}(t)
    \coloneqq \det ( A - t \Id )
    \in       K[t].
  \]
  Das charakteristische Polynom eines Endomorphismus $f \colon V \to V$ ist definiert als $\charpol{f}(t) = \charpol{A}(t)$, wobei $A \coloneqq \repmatrixendo{f}{\basis{B}}$ die darstellende Matrix von $f$ bezüglich einer Basis $\basis{B}$ von $V$ ist.
\end{definition}

Dass das charakteristische Polynom $\charpol{f}(t)$ wohldefiniert ist, also nicht von der Wahl der Basis $\basis{B}$ abhängt, folgt aus dem folgenden Lemma:

\begin{lemma}
  Ähnliche Matrizen haben das gleiche charakterische Polynom.
\end{lemma}

Aus unserer anfänglichen Beobachtung erhalten wir den folgenden Zusammenhang zwischen den Eigenwerten und dem charakteristischen Polynom:

\begin{proposition}
  Die Eigenwerte von $f$ sind genau die Nullstellen des charakteristischen Polynoms $\charpol{f}(t)$.
\end{proposition}





\subsection{Das Minimalpolynom}

\begin{lemma}
  \label{lemma: polynomial equations give restriction for the eigenvalues}
  Es sei $p \in K[t]$ ein Polynom mit $p(f) = 0$.
  Dann ist jeder Eigenwert von $f$ eine Nullstelle von $p$.
\end{lemma}

\begin{definition}
  Es sei
  \[
              \vanishing{f}
    \coloneqq \{ p \in K[t] \suchthat p(f) = 0 \}.
  \]
  Das eindeutige normierte, von $0$ verschiedene Polynom minimalen Grades aus $\vanishing{f}$ ist das \emph{Minimalpolynom} von $f$, und wird mit $\minpol{f}(t) \in K[t]$ notiert.
\end{definition}

\begin{remark}
  Die Wohldefiniertheit von $\vanishing{f}$ nutzt die Endlichdimensionalität von $V$.
  Hierdurch wird sichergestellt, dass $\vanishing{f} \neq 0$ gilt.
\end{remark}

Die Definition des Minimalpolynoms lässt sich bis auf Normiertheit wie folgt umschreiben:

\begin{lemma}
  \label{lemma: properties of the minimal polynomial}
  Es gilt
  \[
      \vanishing{f}
    = \{ p \cdot \minpol{f} \suchthat p \in K[t] \}.
  \]
  Für $p \in K[t]$ gilt also genau dann $p(f) = 0$, wenn $\minpol{f} \divides p$.
  Inbesondere gilt $\minpol{f}(f) = 0$.
\end{lemma}

\begin{theorem}[Cayley--Hamilton]
  Es gilt $\charpol{f}(f) = 0$, also $\minpol{f} \divides \charpol{f}$.
\end{theorem}

Nach dem Satz von Cayley--Hamilton ist jede Nullstelle von $\minpol{f}(t)$ auch eine Nullstelle von $\charpol{f}(t)$, also ein Eigenwert von $f$.
Andererseits ist jeder Eigenwert von $f$ nach Lemma~\ref{lemma: properties of the minimal polynomial} und Lemma~\ref{lemma: polynomial equations give restriction for the eigenvalues} auch eine Nullstelle von $\minpol{f}(t)$.
Somit sind die Nullstelle non $\minpol{f}(t)$ genau die Eigenwerte von $f$.
Also haben $\charpol{f}(t)$ und $\minpol{f}(t)$ die gleichen Nullstellen.
Ist $K$ algebraisch abgeschlossen, so zerfallen $\charpol{f}(t)$ und $\minpol{f}(t)$ somit in die gleichen Linearfaktoren, wobei die Vielfachheit im Minimalpolynom nach dem Satz von Cayley--Hamilton jeweils kleiner ist als die Vielfachheit im charakteristischen Polynom.





\subsection{Diagonalisierbarkeit}

\begin{lemma}
  Es seien $v_1, \dotsc, v_n \in V$ Eigenvektoren von $f \colon V \to V$ zu paarweise verschiedenen Eigenwerten, d.h.\ es gelte $f(v_i) = \lambda_i v_i$ mit $\lambda_i \neq \lambda_j$ für $i \neq j$.
  Dann sind $v_1, \dotsc, v_n$ linear unabhängig.
  Inbesondere ist die Summe $\sum_{\lambda \in K} \eigenspace{V}{f}{\lambda}$ direkt.
\end{lemma}

\begin{definition}
  Ein Endomorphismus $f \colon V \to V$ heiß \emph{diagonalisierbar} falls er die folgenden, äquivalenten Bedingungen erfüllt:
  \begin{enumerate}[label = \arabic*.]
    \item
      Es gilt $V = \bigoplus_{\lambda \in K} \eigenspace{V}{f}{\lambda}$.
    \item
      Es gilt $V = \sum_{\lambda \in K} \eigenspace{V}{f}{\lambda}$.
    \item
      Es gibt eine Basis von $V$ bestehend aus Eigenvektoren von $f$.
    \item
      Es gibt ein Erzeugendensystem von $V$ bestehend aus Eigenvektoren von $f$.
    \item
      Es gibt eine Basis $\basis{B}$ von $V$, so dass die darstellende Matrix $\repmatrixendo{f}{\basis{B}}$ eine Diagonalmatrix ist.
  \end{enumerate}
  Eine Matrix $A \in \matrices{n}{K}$ heißt \emph{diagonalisierbar}, falls sie eine der folgenden, äquivalenten Bedingungen erfüllt:
  \begin{enumerate}[label = \arabic*.]
    \item
      Es gilt $K^n = \bigoplus_{\lambda \in K} \eigenspace{(K^n)}{A}{\lambda}$.
    \item
      Es gilt $K^n = \sum_{\lambda \in K} \eigenspace{(K^n)}{A}{\lambda}$.
    \item
      Es gibt eine Basis von $K^n$ bestehend aus Eigenvektoren von $A$.
    \item
      Es gibt ein Erzeugendensystem von $K^n$ bestehend aus Eigenvektoren von $A$.
    \item
      Die Matrix $A$ ist ähnlich zu einer Diagonalmatrix ist, d.h.\ es gibt $S \in \GL{n}{K}$, so dass $S A S^{-1}$ eine Diagonalmatrix ist.
  \end{enumerate}
\end{definition}

\begin{lemma}
  Für einen Endomorphismus $f \colon V \to V$ sind die folgenden Bedingungen äquivalent:
  \begin{enumerate}
    \item
      Der Endomorphismus $f$ ist diagonlisierbar.
    \item
      Es gibt eine Basis $\basis{B}$ von $V$ gibt, so dass $\repmatrixendo{f}{\basis{B}}$ diagonalisierbar ist.
    \item
      Für jede Basis $\basis{B}$ von $V$ ist $\repmatrixendo{f}{\basis{B}}$ diagonalisierbar.
  \end{enumerate}
\end{lemma}

% TODO: Adding examples.

Ob ein Endomorphismus $f \colon V \to V$ diagonalisierbar ist, hängt nur vom Minimalpolynom $\minpol{f}(t)$ ab:

\begin{proposition}
  Der Endomorphismus $f$ ist genau dann diagonalisierbar, falls $\minpol{f}$ in paarweise verschiedene Linearfaktoren zerfällt.
\end{proposition}





\subsection{Simultane Diagonalisierbarkeit}

\begin{definition}
  Eine Familie $(f_i)_{i \in I}$ von Endomorphismen $f_i \colon V \to V$ heißt \emph{simultan diagonalisierbar}, falls es eine Basis $\basis{B}$ von $V$ gibt, so dass $\repmatrixendo{f}{\basis{B}}$ für jedes $i \in I$ eine Diagonalmatrix ist.
  
  Eine Familie $(A_i)_{i \in I}$ von Matrizen $A_i \in \matrices{n}{K}$ heißt \emph{simultan diagonalisierbar}, falls es $S \in \GL{n}{K}$ gibt, so dass $S A_i S^{-1}$ für jedes $i \in I$ eine Diagonalmatrix ist.
\end{definition}

\begin{lemma}
  Für eine Familie $(f_i)_{i \in I}$ von Endomorphismen $f_i \colon V \to V$ sind die folgenden Bedingungen äquivalent:
  \begin{enumerate}
    \item
      Die Familie von Endomorphismen $(f_i)_{i \in I}$ ist simultan diagonalisierbar.
    \item
      Es gibt eine Basis $\basis{B}$ von $V$, so dass die Familie von Matrizen $(\repmatrixendo{f_i}{\basis{B}})_{i \in I}$ simultan diagonalisierbar ist.
    \item
      Für jede Basis $\basis{B}$ von $V$ ist die Familie von Matrizen $(\repmatrixendo{f_i}{\basis{B}})_{i \in I}$ simultan diagonalisierbar.
  \end{enumerate}
\end{lemma}

\begin{proposition}
  Für Endomorphismen $f_1, \dotsc, f_n \colon V \to V$ sind die folgenden Bedingungen äquivalent:
  \begin{enumerate}
    \item
      Die Familie $(f_1, \dotsc, f_n)$ sind simultan diagonalisierbar.
    \item
      Die Endomorphismen $f_1, \dotsc, f_n$ sind diagonalisierbar und sind paarweise kommutierend, d.h.\ es gilt $f_i f_j = f_j f_i$ für alle $i, j$.
  \end{enumerate}
\end{proposition}

% TODO: Adding examples and calculations.






\subsection{Trigonalisierbarkeit}

\begin{definition}
  Ein Endomorphismus $f \colon V \to V$ heißt trigonalisierbar, falls es eine Basis $\basis{B}$ von $V$ gibt, so dass $\repmatrixendo{f}{\basis{B}}$ eine obere Dreiecksmatrix ist.
  
  Eine Matrix $A \in \matrices{n}{K}$ heißt trigonalisierbar, falls $A$ ähnlich zu einer oberen Dreiecksmatrix ist, d.h.\ falls es $S \in \GL{n}{K}$ gibt, so dass $S A S^{-1}$ eine obere Dreiecksmatrix ist.
\end{definition}

\begin{lemma}
  Für einen Endomorphismus $f \colon V \to V$ sind die folgenden Bedingungen äquivalent:
  \begin{enumerate}
    \item
      Der Endomorphismus $f$ ist trigonalisierbar.
    \item
      Es gibt eine Basis $\basis{B}$ von $V$, so dass die darstellende Matrix $\repmatrixendo{f}{\basis{B}}$ trigonalisierbar ist.
    \item
      Für jede Basis $\basis{B}$ von $V$ ist die darstellende Matrix $\repmatrixendo{f}{\basis{B}}$ trigonalisierbar.
  \end{enumerate}
\end{lemma}

Die Trigonalisierbarkeit eines Endomorphismus $f \colon V \to V$ hängt nur von dem charakterischen Polynom $\charpol{f}(t)$ ab:

\begin{proposition}
  Ein Endomorphismus $f \colon V \to V$ ist genau dann trigonalisierbar, wenn das charakteristische Polynom $\charpol{f}(t)$ in Linearfaktoren zerfällt.
\end{proposition}

Insbesondere ist jeder Endomorphismus $f \colon V \to V$ trigonalisierbar, falls $K$ algebraisch abgeschlossen ist.

% Adding characterisation via invariant flags.




